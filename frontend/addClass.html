<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<div class="jumbotron text-center" style="background-color: #122B4A">
  <h1 style="color: #D67713; font-size:50px" align="center">
    Search for a class you want to add!
  </h1>
</div>

<style>
body {
  background-color: #D3D3D3;
}
</style>



<h7 style="font-size:20px"> Department Acronym: </h7> <br> <input type="text" class="form-control" placeholder="E.g. CS" id="departmentAcroynm"
style="width: 7%">
<br>
<h7 style="font-size:20px"> Course Number: </h7> <br> <input type="text" class="form-control" placeholder="E.g 411" id="courseNumber" style="width: 7%">
<br>

<button class="btn btn-default btn-lg" id="submit"> Find Classes </button>
<br>
<script>
  function concatenate() {
    var departmentAcr = document.getElementById("departmentAcroynm").value;
    var courseNum = document.getElementById("courseNumber").value;
    var returnVal =  departmentAcr + courseNum;
		if(returnVal === ""){
			returnVal = "CS411";
		}

		return returnVal;
  }
</script>

<script>
  $(document.getElementById("submit")).click(function(){
    $(document.getElementById("addedClassDiv")).empty();
    $.getJSON("/api/find_class?q=" + concatenate(), function(result) {
    })
    .done(function(result) {
        console.log(result);
        var buttonHolder = "<br>";
        for (var i in result["message"].results) {
          buttonHolder += "<p1> " + result["message"].results[i].class + "     " + "CRN: " + result["message"].results[i].crn
            + "</p1>" + "<br>" + "<button class='btn btn-default btn-sm' id=button" +
            result["message"].results[i].crn + " onclick=addClick(" + result["message"].results[i].crn + ") "
              + "<br>" + "Add me </button>"
          buttonHolder += "<br>";
          buttonHolder += "<br>";
        }
        $(document.getElementById("buttonList")).empty().append(buttonHolder);
  })
  .fail(function(jqXHR, textStatus, errorThrown) { alert('getJSON request failed! ' + textStatus); })

});
</script>

<script>
  function addClick(crn) {
    console.log("In addClick");
    console.log(crn);
    $.post("/api/add_class?crn=" + crn, function(result) {
    })
    .done(function(result) {
      console.log("here");
      $(document.getElementById("addedClassDiv")).empty().append("Added class with CRN: " + crn);
    })
    .fail(function(jqXHR, textStatus, errorThrown) { alert('getJSON request failed! ' + textStatus);
    })
}
</script>
<div id="buttonList">
</div>

<div id="addedClassDiv">
</div>
<form method="get" action="/calendar.html">
  <button class="btn btn-default btn-lg" type="submit">Go To Your Calendar!</button>
</form>

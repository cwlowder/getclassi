
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


<div id="classHeaderDiv">
</div>

<div id="instructorDiv">
</div>

<div id="crnDiv">
</div>

<div id="classDescription">
</div>

<div id="classAssignmentList">
</div>

<div id="notesSection">
  <div id="currNote"> Note
  </div>
  Change Note?
  <br>
  <textarea id="notesBox" maxlength="280" rows="4" cols="70"></textarea>
  <br>
  <button id="updateNote" onclick="updateNote()">Update Note! </button>
</div>

<script>
  $(document).ready(function() {
    $.getJSON("/api/class_info?crn=" + getCrn(), function(result) {

    })
    .done(function(result) {
      var info = result["message"];
      $(document.getElementById("classHeaderDiv")).append(info.class);
      $(document.getElementById("crnDiv")).append(info.crn);
      $(document.getElementById("currNote")).empty().append(info.note);
    })
    .fail(function(jqXHR, textStatus, errorThrown) { alert('getJSON request failed! ' + textStatus); })
  })
</script>

<script>
  function updateNote() {
    var message = document.getElementById("notesBox").value;
    console.log(message);
    $.post("/api/set_note?crn=" + getCrn(), JSON.stringify({note: message}) , function(result) {

    })
    .done(function(result) {
      console.log("Note updated");
      $(document.getElementById("currNote")).empty().append(message);
      location.reload(true);
    })
    .fail(function(jqXHR, textStatus, errorThrown) {
      console.log("Failed");
    })
  }
</script>

<script>
	function getCrn() {
		var url_string = window.location.href;
		var url = new URL(url_string);
		var c = url.searchParams.get("crn");
		console.log(c);
    return c;
	}
</script>


<body>
	<form method="get" action="/calendar.html">
	  <button type="submit">Go To Your Calendar!</button>
	</form>
</body>

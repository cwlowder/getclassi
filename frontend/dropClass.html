<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<div class="jumbotron text-center" style="background-color: #122B4A">
<h1 style="color: #D67713; font-size:50px" align="center">
  What class do you want to drop?
</h1>
</div>
<style>
body {
  background-color: #D3D3D3;
}
</style>

<script>
  $(document).ready(function(){
    $(document.getElementById("dropClassDiv")).empty();
    $.getJSON("/api/calendar?date=today", function(result) {
    })
    .done(function(result) {
        console.log(result);
        var buttonHolder = "<br>";
        for (var i in result["message"].titles) {
          buttonHolder += "<p1> " + result["message"].titles[i] + "     " + "CRN: " + i
            + "</p1>" + "<br>" + "<button class='btn btn-default btn-sm' id=button" +
            i + " onclick=addClick(" + i + ") "
              + "<br>" + "Drop Me! </button>"
          buttonHolder += "<br>";
          buttonHolder += "<br>";
        }
        $(document.getElementById("buttonList")).empty().append(buttonHolder);
  })
  .fail(function(jqXHR, textStatus, errorThrown) { alert('getJSON request failed! ' + textStatus); })

});
</script>

<script>
  function addClick(crn) {
    console.log("In dropClick");
    console.log(crn);
    $.post("/api/drop_class?crn=" + crn, function(result) {
    })
    .done(function(result) {
      console.log("here");
			location.reload(true);
      $(document.getElementById("dropClassDiv")).empty().append("Dropped class with CRN: " + crn);
    })
    .fail(function(jqXHR, textStatus, errorThrown) { alert('Failed to drop class!' + textStatus);

			location.reload(true);
    })
}
</script>
<div id="buttonList">
</div>

<div id="dropClassDiv">
</div>
<form method="get" action="/calendar.html">
  <button class="btn btn-default btn-lg" type="submit">Go To Your Calendar!</button>
</form>
